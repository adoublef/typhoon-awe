version: '3'

tasks:
  dev:
    cmd: infisical run --env=dev -- deno run --allow-net --allow-read --allow-ffi --allow-env --unstable cmd/typhoon-awe/dev.ts
    silent: true

  apply:
    cmds: 
      - infisical run --env=prod -- atlas schema apply --env=iam
    # ENV with default as `dev`

  test:
    cmd: deno test -A --unstable --parallel --ignore=lib/libsql/ {{ .DIR }}

  htmx:
    cmds:
      - curl -L -o static/htmx.min.js https://unpkg.com/htmx.org@latest/dist/htmx.min.js
      - curl -L -o static/hyperscript.min.js https://unpkg.com/hyperscript.org@latest/dist/_hyperscript.min.js